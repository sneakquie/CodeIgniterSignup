(function(e,t){"use strict";function s(t){t=e.extend({},r,t||{});if(n===null){n=e("body")}var i=e(this);for(var s=0,u=i.length;s<u;s++){o(i.eq(s),t)}return i}function o(n,r){if(!n.hasClass("scroller")){r=e.extend({},r,n.data("scroller-options"));var s="";s+='<div class="scroller-bar">';s+='<div class="scroller-track">';s+='<div class="scroller-handle">';s+="</div></div></div>";r.paddingRight=parseInt(n.css("padding-right"),10);r.paddingBottom=parseInt(n.css("padding-bottom"),10);n.addClass(r.customClass+" scroller").wrapInner('<div class="scroller-content" />').prepend(s);if(r.horizontal){n.addClass("scroller-horizontal")}var o=e.extend({$scroller:n,$content:n.find(".scroller-content"),$bar:n.find(".scroller-bar"),$track:n.find(".scroller-track"),$handle:n.find(".scroller-handle")},r);o.trackMargin=parseInt(o.trackMargin,10);o.$content.on("scroll.scroller",o,u);o.$scroller.on("touchstart.scroller mousedown.scroller",".scroller-track",o,a).on("touchstart.scroller mousedown.scroller",".scroller-handle",o,f).data("scroller",o);i.reset.apply(n);e(t).one("load",function(){i.reset.apply(n)})}}function u(e){e.preventDefault();e.stopPropagation();var t=e.data;if(t.horizontal){var n=t.$content.scrollLeft();if(n<0){n=0}var r=n/t.scrollRatio;if(r>t.handleBounds.right){r=t.handleBounds.right}t.$handle.css({left:r})}else{var i=t.$content.scrollTop();if(i<0){i=0}var s=i/t.scrollRatio;if(s>t.handleBounds.bottom){s=t.handleBounds.bottom}t.$handle.css({top:s})}}function a(e){e.preventDefault();e.stopPropagation();var t=e.data,r=e.originalEvent,i=t.$track.offset(),s=typeof r.targetTouches!=="undefined"?r.targetTouches[0]:null;var o=s?s.pageX:e.clientX,u=s?s.pageY:e.clientY;if(t.horizontal){t.mouseStart=o;t.handleLeft=o-i.left-t.handleWidth/2;p.apply(t.$scroller,[t,t.handleLeft])}else{t.mouseStart=u;t.handleTop=u-i.top-t.handleHeight/2;p.apply(t.$scroller,[t,t.handleTop])}t.$content.off(".scroller");n.on("touchmove.scroller mousemove.scroller",t,l).on("touchend.scroller mouseup.scroller",t,c)}function f(e){e.preventDefault();e.stopPropagation();var t=e.data,r=e.originalEvent,i=typeof r.targetTouches!=="undefined"?r.targetTouches[0]:null;var s=i?i.pageX:e.clientX,o=i?i.pageY:e.clientY;if(t.horizontal){t.mouseStart=s;t.handleLeft=parseInt(t.$handle.css("left"),10)}else{t.mouseStart=o;t.handleTop=parseInt(t.$handle.css("top"),10)}t.$content.off(".scroller");n.on("touchmove.scroller mousemove.scroller",t,l).on("touchend.scroller mouseup.scroller",t,c)}function l(e){e.preventDefault();e.stopPropagation();var t=e.data,n=e.originalEvent,r=0,i=0,s=typeof n.targetTouches!=="undefined"?n.targetTouches[0]:null;var o=s?s.pageX:e.clientX,u=s?s.pageY:e.clientY;if(t.horizontal){i=t.mouseStart-o;r=t.handleLeft-i}else{i=t.mouseStart-u;r=t.handleTop-i}p.apply(t.$scroller,[t,r])}function c(e){e.preventDefault();e.stopPropagation();var t=e.data;t.$content.on("scroll.scroller",t,u);n.off(".scroller")}function h(e){e.preventDefault();e.stopPropagation();var t=e.data;t.$content.on("scroll.scroller",t,u);n.off(".scroller")}function p(e,t){if(e.horizontal){if(t<e.handleBounds.left){t=e.handleBounds.left}if(t>e.handleBounds.right){t=e.handleBounds.right}var n=Math.round(t*e.scrollRatio);e.$handle.css({left:t});e.$content.scrollLeft(n)}else{if(t<e.handleBounds.top){t=e.handleBounds.top}if(t>e.handleBounds.bottom){t=e.handleBounds.bottom}var r=Math.round(t*e.scrollRatio);e.$handle.css({top:t});e.$content.scrollTop(r)}}var n=null;var r={customClass:"",duration:0,handleSize:0,horizontal:false,trackMargin:0};var i={defaults:function(t){r=e.extend(r,t||{});return e(this)},destroy:function(){return e(this).each(function(t,n){var r=e(n).data("scroller");if(r){r.$scroller.removeClass(r.customClass).removeClass("scroller").removeClass("scroller-active");r.$bar.remove();r.$content.contents().unwrap();r.$content.off(".scroller");r.$scroller.off(".scroller").removeData("scroller")}})},scroll:function(t,n){return e(this).each(function(n){var i=e(this).data("scroller"),s=s||r.duration;if(typeof t!=="number"){var o=e(t);if(o.length>0){var u=o.position();if(i.horizontal){t=u.left+i.$content.scrollLeft()}else{t=u.top+i.$content.scrollTop()}}else{t=i.$content.scrollTop()}}if(i.horizontal){i.$content.stop().animate({scrollLeft:t},s)}else{i.$content.stop().animate({scrollTop:t},s)}})},reset:function(){return e(this).each(function(t){var n=e(this).data("scroller");if(n){n.$scroller.addClass("scroller-setup");if(n.horizontal){n.barHeight=n.$content[0].offsetHeight-n.$content[0].clientHeight;n.frameWidth=n.$content.outerWidth();n.trackWidth=n.frameWidth-n.trackMargin*2;n.scrollWidth=n.$content[0].scrollWidth;n.ratio=n.trackWidth/n.scrollWidth;n.trackRatio=n.trackWidth/n.scrollWidth;n.handleWidth=n.handleSize>0?n.handleSize:n.trackWidth*n.trackRatio;n.scrollRatio=(n.scrollWidth-n.frameWidth)/(n.trackWidth-n.handleWidth);n.handleBounds={left:0,right:n.trackWidth-n.handleWidth};n.$content.css({paddingBottom:n.barHeight+n.paddingBottom});var r=n.$content.scrollLeft(),i=r*n.ratio;if(n.scrollWidth<=n.frameWidth){n.$scroller.removeClass("scroller-active")}else{n.$scroller.addClass("scroller-active")}n.$bar.css({width:n.frameWidth});n.$track.css({width:n.trackWidth,marginLeft:n.trackMargin,marginRight:n.trackMargin});n.$handle.css({width:n.handleWidth});p.apply(n.$scroller,[n,i])}else{n.barWidth=n.$content[0].offsetWidth-n.$content[0].clientWidth;n.frameHeight=n.$content.outerHeight();n.trackHeight=n.frameHeight-n.trackMargin*2;n.scrollHeight=n.$content[0].scrollHeight;n.ratio=n.trackHeight/n.scrollHeight;n.trackRatio=n.trackHeight/n.scrollHeight;n.handleHeight=n.handleSize>0?n.handleSize:n.trackHeight*n.trackRatio;n.scrollRatio=(n.scrollHeight-n.frameHeight)/(n.trackHeight-n.handleHeight);n.handleBounds={top:0,bottom:n.trackHeight-n.handleHeight};var s=n.$content.scrollTop(),o=s*n.ratio;if(n.scrollHeight<=n.frameHeight){n.$scroller.removeClass("scroller-active")}else{n.$scroller.addClass("scroller-active")}n.$bar.css({height:n.frameHeight});n.$track.css({height:n.trackHeight,marginBottom:n.trackMargin,marginTop:n.trackMargin});n.$handle.css({height:n.handleHeight});p.apply(n.$scroller,[n,o])}n.$scroller.removeClass("scroller-setup")}})}};e.fn.scroller=function(e){if(i[e]){return i[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return s.apply(this,arguments)}return this};e.scroller=function(e){if(e==="defaults"){i.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}})(jQuery)